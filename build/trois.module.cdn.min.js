import{toRef as Fe,watch as c,ref as bs,defineComponent as a,watchEffect as vs,inject as q,provide as _s,getCurrentInstance as Ps,onUnmounted as Ss,createApp as ws}from"https://unpkg.com/vue@3.2.20/dist/vue.esm-browser.prod.js";import{EventDispatcher as Ms,Ray as xs,Plane as Ue,MathUtils as Es,Vector3 as j,MOUSE as Q,TOUCH as J,Quaternion as Be,Spherical as He,Vector2 as _,Raycaster as Ls,InstancedMesh as ae,WebGLRenderer as Cs,OrthographicCamera as Ts,PerspectiveCamera as Os,Scene as Rs,Color as he,Texture as Ds,Group as Ns,WebGLCubeRenderTarget as js,RGBAFormat as Gs,LinearMipmapLinearFilter as ks,CubeCamera as As,Mesh as zs,BufferGeometry as Is,BufferAttribute as $s,BoxGeometry as Le,CircleGeometry as Fs,ConeGeometry as Us,CylinderGeometry as Bs,DodecahedronGeometry as Hs,ExtrudeGeometry as Ye,IcosahedronGeometry as Ys,LatheGeometry as Ks,OctahedronGeometry as Zs,PlaneGeometry as Ke,PolyhedronGeometry as Xs,RingGeometry as Vs,SphereGeometry as Ws,ShapeGeometry as qs,TetrahedronGeometry as Qs,TorusGeometry as Js,TorusKnotGeometry as ei,CatmullRomCurve3 as Ze,Curve as ti,TubeGeometry as ri,SpotLight as Ce,DirectionalLight as Te,AmbientLight as si,HemisphereLight as ii,PointLight as oi,RectAreaLight as ni,MeshBasicMaterial as Xe,MeshLambertMaterial as ai,MeshPhongMaterial as hi,MeshPhysicalMaterial as li,PointsMaterial as di,ShadowMaterial as ci,MeshStandardMaterial as ui,MeshToonMaterial as pi,TextureLoader as le,MeshMatcapMaterial as mi,ShaderMaterial as Oe,ShaderChunk as ee,UniformsUtils as Ve,ShaderLib as fi,CubeReflectionMapping as yi,CubeTextureLoader as gi,VideoTexture as bi,DoubleSide as vi,SpriteMaterial as _i,Sprite as Pi,Points as Si,GridHelper as wi}from"https://cdn.skypack.dev/three@0.136.0/build/three.module.js";import{mergeBufferGeometries as Mi}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/utils/BufferGeometryUtils";import{RectAreaLightUniformsLib as xi}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/lights/RectAreaLightUniformsLib.js";import{RectAreaLightHelper as Ei}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/helpers/RectAreaLightHelper.js";import{TextGeometry as Li}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/geometries/TextGeometry.js";import{FontLoader as Ci}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/loaders/FontLoader.js";import{GLTFLoader as Ti}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/loaders/GLTFLoader.js";import{FBXLoader as Oi}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/loaders/FBXLoader.js";import{EffectComposer as Ri}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/EffectComposer.js";import{RenderPass as Di}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/RenderPass.js";import{BokehPass as Ni}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/BokehPass.js";import{FilmPass as ji}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/FilmPass.js";import{ShaderPass as fe}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/ShaderPass.js";import{FXAAShader as Gi}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/shaders/FXAAShader.js";import{HalftonePass as ki}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/HalftonePass.js";import{SMAAPass as Ai}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/SMAAPass.js";import{SSAOPass as zi}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/SSAOPass.js";import{UnrealBloomPass as Ii}from"https://cdn.skypack.dev/three@0.136.0/examples/jsm/postprocessing/UnrealBloomPass.js";function te(e,t,r){t instanceof Object&&Object.entries(t).forEach(([s,i])=>{r?r(e,s,i):e[s]=i})}function H(e,t,r,s=!0,i){s&&te(r,e[t],i);const o=Fe(e,t);return c(o,n=>{te(r,n,i)})}function We(e,t,r=!0,s){r&&te(t,e,s);const i=bs(e);return c(i,o=>{te(t,o,s)},{deep:!0})}function re(e,t){t instanceof Object&&Object.entries(t).forEach(([r,s])=>{e[r]=s})}function qe(e,t,r){t.forEach(s=>{g(e,s,r,s)})}function g(e,t,r,s){const i=s||t,o=Fe(e,t);o.value instanceof Object?(re(r[i],o.value),c(o,n=>{re(r[i],n)},{deep:!0})):(o.value!==void 0&&(r[i]=e[t]),c(o,n=>{r[i]=n}))}function de(e,t=[]){const r={};return Object.entries(e).forEach(([s,i])=>{(!t||!t.includes(s))&&(r[s]=i)}),r}function Qe(e,t,r){return r=r<0?0:r,r=r>1?1:r,e+(t-e)*r}function Je(e,t,r){return e<t?t:e>r?r:e}const $i="https://rawcdn.githack.com/emmelleppi/matcaps/9b36ccaaf0a24881a39062d05566c9e92be4aa0d",Fi="0404E8_0404B5_0404CB_3333FC";function Re(e=Fi,t=1024){const r=`${e}${Ui(t)}.png`;return`${$i}/${t}/${r}`}function Ui(e){switch(e){case 64:return"-64px";case 128:return"-128px";case 256:return"-256px";case 512:return"-512px";default:return""}}class Bi extends Ms{constructor(t,r=null){super(),this.object=t,this.domElement=r,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}const et={type:"change"},De={type:"start"},tt={type:"end"},ye=new xs,rt=new Ue,Hi=Math.cos(70*Es.DEG2RAD),P=new j,G=2*Math.PI,u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Ne=1e-6;class Yi extends Bi{constructor(t,r=null){super(t,r),this.state=u.NONE,this.target=new j,this.cursor=new j,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateThreshold=0,this.autoRotateThresholdTrigger=2,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Q.ROTATE,MIDDLE:Q.DOLLY,RIGHT:Q.PAN},this.touches={ONE:J.ROTATE,TWO:J.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new j,this._lastQuaternion=new Be,this._lastTargetPosition=new j,this._quat=new Be().setFromUnitVectors(t.up,new j(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new He,this._sphericalDelta=new He,this._scale=1,this._panOffset=new j,this._rotateStart=new _,this._rotateEnd=new _,this._rotateDelta=new _,this._panStart=new _,this._panEnd=new _,this._panDelta=new _,this._dollyStart=new _,this._dollyEnd=new _,this._dollyDelta=new _,this._dollyDirection=new j,this._mouse=new _,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Zi.bind(this),this._onPointerDown=Ki.bind(this),this._onPointerUp=Xi.bind(this),this._onContextMenu=to.bind(this),this._onMouseWheel=qi.bind(this),this._onKeyDown=Qi.bind(this),this._onTouchStart=Ji.bind(this),this._onTouchMove=eo.bind(this),this._onMouseDown=Vi.bind(this),this._onMouseMove=Wi.bind(this),this._interceptControlDown=ro.bind(this),this._interceptControlUp=so.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(et),this.update(),this.state=u.NONE}update(t=null){const r=this.object.position;P.copy(r).sub(this.target),P.applyQuaternion(this._quat),this._spherical.setFromVector3(P),this.autoRotate&&this.state===u.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let s=this.minAzimuthAngle,i=this.maxAzimuthAngle;isFinite(s)&&isFinite(i)&&(s<-Math.PI?s+=G:s>Math.PI&&(s-=G),i<-Math.PI?i+=G:i>Math.PI&&(i-=G),s<=i?this._spherical.theta=Math.max(s,Math.min(i,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(s+i)/2?Math.max(s,this._spherical.theta):Math.min(i,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const n=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=n!=this._spherical.radius}if(P.setFromSpherical(this._spherical),P.applyQuaternion(this._quatInverse),r.copy(this.target).add(P),this.object.lookAt(this.target),this.enableDamping===!0?(console.log(this._sphericalDelta.theta,this.autoRotateThresholdTrigger,this.autoRotateThreshold),Math.abs(this._sphericalDelta.theta)>this.autoRotateThresholdTrigger&&(this.autoRotateThresholdTriggered=!0),Math.abs(this._sphericalDelta.theta)<this.autoRotateThreshold-.01&&(this.autoRotateThresholdTriggered=!1),(!this.autoRotateThresholdTriggered||Math.abs(this._sphericalDelta.theta)>this.autoRotateThreshold)&&(this._sphericalDelta.theta*=1-this.dampingFactor),this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let n=null;if(this.object.isPerspectiveCamera){const d=P.length();n=this._clampDistance(d*this._scale);const x=d-n;this.object.position.addScaledVector(this._dollyDirection,x),this.object.updateMatrixWorld(),o=!!x}else if(this.object.isOrthographicCamera){const d=new j(this._mouse.x,this._mouse.y,0);d.unproject(this.object);const x=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=x!==this.object.zoom;const R=new j(this._mouse.x,this._mouse.y,0);R.unproject(this.object),this.object.position.sub(R).add(d),this.object.updateMatrixWorld(),n=P.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;n!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(n).add(this.object.position):(ye.origin.copy(this.object.position),ye.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(ye.direction))<Hi?this.object.lookAt(this.target):(rt.setFromNormalAndCoplanarPoint(this.object.up,this.target),ye.intersectPlane(rt,this.target))))}else if(this.object.isOrthographicCamera){const n=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),n!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,o||this._lastPosition.distanceToSquared(this.object.position)>Ne||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Ne||this._lastTargetPosition.distanceToSquared(this.target)>Ne?(this.dispatchEvent(et),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?G/60*this.autoRotateSpeed*t:G/60/60*this.autoRotateSpeed}_getZoomScale(t){const r=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*r)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,r){P.setFromMatrixColumn(r,0),P.multiplyScalar(-t),this._panOffset.add(P)}_panUp(t,r){this.screenSpacePanning===!0?P.setFromMatrixColumn(r,1):(P.setFromMatrixColumn(r,0),P.crossVectors(this.object.up,P)),P.multiplyScalar(t),this._panOffset.add(P)}_pan(t,r){const s=this.domElement;if(this.object.isPerspectiveCamera){const i=this.object.position;P.copy(i).sub(this.target);let o=P.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*o/s.clientHeight,this.object.matrix),this._panUp(2*r*o/s.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/s.clientWidth,this.object.matrix),this._panUp(r*(this.object.top-this.object.bottom)/this.object.zoom/s.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,r){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const s=this.domElement.getBoundingClientRect(),i=t-s.left,o=r-s.top,n=s.width,d=s.height;this._mouse.x=i/n*2-1,this._mouse.y=-(o/d)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const r=this.domElement;this._rotateLeft(G*this._rotateDelta.x/r.clientHeight),this._rotateUp(G*this._rotateDelta.y/r.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let r=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(G*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),r=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-G*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),r=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(G*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),r=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-G*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),r=!0;break}r&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const r=this._getSecondPointerPosition(t),s=.5*(t.pageX+r.x),i=.5*(t.pageY+r.y);this._rotateStart.set(s,i)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const r=this._getSecondPointerPosition(t),s=.5*(t.pageX+r.x),i=.5*(t.pageY+r.y);this._panStart.set(s,i)}}_handleTouchStartDolly(t){const r=this._getSecondPointerPosition(t),s=t.pageX-r.x,i=t.pageY-r.y,o=Math.sqrt(s*s+i*i);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),i=.5*(t.pageX+s.x),o=.5*(t.pageY+s.y);this._rotateEnd.set(i,o)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const r=this.domElement;this._rotateLeft(G*this._rotateDelta.x/r.clientHeight),this._rotateUp(G*this._rotateDelta.y/r.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const r=this._getSecondPointerPosition(t),s=.5*(t.pageX+r.x),i=.5*(t.pageY+r.y);this._panEnd.set(s,i)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const r=this._getSecondPointerPosition(t),s=t.pageX-r.x,i=t.pageY-r.y,o=Math.sqrt(s*s+i*i);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const n=(t.pageX+r.x)*.5,d=(t.pageY+r.y)*.5;this._updateZoomParameters(n,d)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let r=0;r<this._pointers.length;r++)if(this._pointers[r]==t.pointerId){this._pointers.splice(r,1);return}}_isTrackingPointer(t){for(let r=0;r<this._pointers.length;r++)if(this._pointers[r]==t.pointerId)return!0;return!1}_trackPointer(t){let r=this._pointerPositions[t.pointerId];r===void 0&&(r=new _,this._pointerPositions[t.pointerId]=r),r.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const r=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[r]}_customWheelEvent(t){const r=t.deltaMode,s={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(r){case 1:s.deltaY*=16;break;case 2:s.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(s.deltaY*=10),s}}function Ki(e){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(e)&&(this._addPointer(e),e.pointerType==="touch"?this._onTouchStart(e):this._onMouseDown(e)))}function Zi(e){this.enabled!==!1&&(e.pointerType==="touch"?this._onTouchMove(e):this._onMouseMove(e))}function Xi(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(tt),this.state=u.NONE;break;case 1:const t=this._pointers[0],r=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:r.x,pageY:r.y});break}}function Vi(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Q.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(e),this.state=u.DOLLY;break;case Q.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(e),this.state=u.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(e),this.state=u.ROTATE}break;case Q.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(e),this.state=u.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(e),this.state=u.PAN}break;default:this.state=u.NONE}this.state!==u.NONE&&this.dispatchEvent(De)}function Wi(e){switch(this.state){case u.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(e);break;case u.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(e);break;case u.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(e);break}}function qi(e){this.enabled===!1||this.enableZoom===!1||this.state!==u.NONE||(e.preventDefault(),this.dispatchEvent(De),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(tt))}function Qi(e){this.enabled!==!1&&this._handleKeyDown(e)}function Ji(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case J.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(e),this.state=u.TOUCH_ROTATE;break;case J.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(e),this.state=u.TOUCH_PAN;break;default:this.state=u.NONE}break;case 2:switch(this.touches.TWO){case J.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(e),this.state=u.TOUCH_DOLLY_PAN;break;case J.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(e),this.state=u.TOUCH_DOLLY_ROTATE;break;default:this.state=u.NONE}break;default:this.state=u.NONE}this.state!==u.NONE&&this.dispatchEvent(De)}function eo(e){switch(this._trackPointer(e),this.state){case u.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(e),this.update();break;case u.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(e),this.update();break;case u.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(e),this.update();break;case u.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=u.NONE}}function to(e){this.enabled!==!1&&e.preventDefault()}function ro(e){e.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function so(e){e.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function io(e){const{camera:t,resetPosition:r=new j(0,0,0)}=e,s=new Ls,i=r.clone(),o=new Ue(new j(0,0,1),0);return{position:i,updatePosition:n=>{s.setFromCamera(n,t),t.getWorldDirection(o.normal),s.ray.intersectPlane(o,i)},intersect:(n,d,x=!1)=>(s.setFromCamera(n,t),s.intersectObjects(d,x))}}function st(e){const{camera:t,domElement:r,intersectObjects:s,intersectRecursive:i=!1,touch:o=!0,resetOnEnd:n=!1,onEnter:d=()=>{},onMove:x=()=>{},onDown:R=()=>{},onUp:S=()=>{},onLeave:A=()=>{},onClick:U=()=>{},onIntersectEnter:T=()=>{},onIntersectOver:Y=()=>{},onIntersectMove:K=()=>{},onIntersectLeave:I=()=>{},onIntersectUp:B=()=>{},onIntersectDown:Z=()=>{},onIntersectClick:h=()=>{}}=e,l=new _(0,0),m=new _(0,0),w=io({camera:t}),X=w.position,xe={position:l,positionN:m,positionV3:X,intersectObjects:s,listeners:!1,addListeners:ys,removeListeners:gs,intersect:Ge};return xe;function fs(){l.set(0,0),m.set(0,0),X.set(0,0,0)}function oe(f){let y,E;f.touches&&f.touches.length>0?(y=f.touches[0].clientX,E=f.touches[0].clientY):(y=f.clientX,E=f.clientY);const L=r.getBoundingClientRect();l.x=y-L.left,l.y=E-L.top,m.x=l.x/L.width*2-1,m.y=-(l.y/L.height)*2+1,w.updatePosition(m)}function Ge(){const f=me();if(f.length){const y=w.intersect(m,f,i),E=[...f],L=[];y.forEach(C=>{var D,b,p;const{object:v}=C,N=ne(v);if(v instanceof ae){if(L.indexOf(v)!==-1)return;L.push(v)}if(!v.userData.over){v.userData.over=!0;const Ee={type:"pointerover",over:!0,component:N,intersect:C,intersects:y},$e={...Ee,type:"pointerenter"};Y(Ee),T($e),(D=N==null?void 0:N.onPointerOver)==null||D.call(N,Ee),(b=N==null?void 0:N.onPointerEnter)==null||b.call(N,$e)}const Ie={type:"pointermove",component:N,intersect:C};K(Ie),(p=N==null?void 0:N.onPointerMove)==null||p.call(N,Ie),E.splice(E.indexOf(v),1)}),E.forEach(C=>{var D,b;const p=ne(C);if(C.userData.over){C.userData.over=!1;const v={type:"pointerover",over:!1,component:p},N={...v,type:"pointerleave"};Y(v),I(N),(D=p==null?void 0:p.onPointerOver)==null||D.call(p,v),(b=p==null?void 0:p.onPointerLeave)==null||b.call(p,N)}})}}function ce(f){oe(f),d({type:"pointerenter",position:l,positionN:m,positionV3:X})}function ue(f){oe(f),x({type:"pointermove",position:l,positionN:m,positionV3:X}),Ge()}function ke(f){oe(f);const y=me();if(y.length){const E=w.intersect(m,y,i),L=[];E.forEach(C=>{var D;const{object:b}=C,p=ne(b);if(b instanceof ae){if(L.indexOf(b)!==-1)return;L.push(b)}const v={type:"pointerdown",component:p,intersect:C,intersects:E};Z(v),(D=p==null?void 0:p.onPointerDown)==null||D.call(p,v)})}R({type:"pointerdown",position:l,positionN:m,positionV3:X})}function Ae(f){oe(f);const y=me();if(y.length){const E=w.intersect(m,y,i),L=[];E.forEach(C=>{var D;const{object:b}=C,p=ne(b);if(b instanceof ae){if(L.indexOf(b)!==-1)return;L.push(b)}const v={type:"pointerup",component:p,intersect:C,intersects:E};B(v),(D=p==null?void 0:p.onPointerUp)==null||D.call(p,v)})}S({type:"pointerup",position:l,positionN:m,positionV3:X})}function ze(f){oe(f);const y=me();if(y.length){const E=w.intersect(m,y,i),L=[];E.forEach(C=>{var D;const{object:b}=C,p=ne(b);if(b instanceof ae){if(L.indexOf(b)!==-1)return;L.push(b)}const v={type:"click",component:p,intersect:C,intersects:E};h(v),(D=p==null?void 0:p.onClick)==null||D.call(p,v)})}U({type:"click",position:l,positionN:m,positionV3:X})}function pe(){n&&fs(),A({type:"pointerleave"})}function ne(f){if(f.userData.component)return f.userData.component;let y=f.parent;for(;y;){if(y.userData.component)return y.userData.component;y=y.parent}}function me(){return typeof s=="function"?s():s}function ys(){r.addEventListener("mouseenter",ce),r.addEventListener("mousemove",ue),r.addEventListener("mouseleave",pe),r.addEventListener("pointerdown",ke),r.addEventListener("pointerup",Ae),r.addEventListener("click",ze),o&&(r.addEventListener("touchstart",ce),r.addEventListener("touchmove",ue),r.addEventListener("touchend",pe)),xe.listeners=!0}function gs(){r.removeEventListener("mouseenter",ce),r.removeEventListener("mousemove",ue),r.removeEventListener("mouseleave",pe),r.removeEventListener("pointerdown",ke),r.removeEventListener("pointerup",Ae),r.removeEventListener("click",ze),r.removeEventListener("touchstart",ce),r.removeEventListener("touchmove",ue),r.removeEventListener("touchend",pe),xe.listeners=!1}}function oo(e){const t={antialias:!0,alpha:!1,autoClear:!0,orbitCtrl:!1,pointer:!1,resize:!1,width:300,height:150};e&&Object.entries(e).forEach(([h,l])=>{t[h]=l});const r={width:1,height:1,wWidth:1,wHeight:1,ratio:1},s=[],i=[],o=d(),n={config:t,renderer:o,size:r,init:x,dispose:K,render:A,renderC:U,setSize:B,addIntersectObject:T,removeIntersectObject:Y};return n;function d(){const h=new Cs({canvas:t.canvas,antialias:t.antialias,alpha:t.alpha,...t.params});return h.autoClear=t.autoClear,h}function x(){if(!n.scene)return console.error("Missing Scene"),!1;if(!n.camera)return console.error("Missing Camera"),!1;if(t.resize?(I(),window.addEventListener("resize",I)):t.width&&t.height&&B(t.width,t.height),R(),t.orbitCtrl){const h=new Yi(n.camera,n.renderer.domElement);t.orbitCtrl instanceof Object&&Object.entries(t.orbitCtrl).forEach(([l,m])=>{h[l]=m}),S(()=>{h.update()}),n.cameraCtrl=h}return!0}function R(){let h={camera:n.camera,domElement:n.renderer.domElement,intersectObjects:i};t.pointer&&t.pointer instanceof Object&&(h={...h,...t.pointer});const l=n.pointer=st(h);(t.pointer||i.length)&&(l.addListeners(),h.intersectMode==="frame"&&S(l.intersect))}function S(h){s.push(h)}function A(){s.forEach(h=>h()),n.renderer.render(n.scene,n.camera)}function U(){s.forEach(h=>h()),n.composer.render()}function T(h){i.indexOf(h)===-1&&i.push(h),n.pointer&&!n.pointer.listeners&&n.pointer.addListeners()}function Y(h){const l=i.indexOf(h);l!==-1&&i.splice(l,1),n.pointer&&!t.pointer&&i.length===0&&n.pointer.removeListeners()}function K(){window.removeEventListener("resize",I),n.pointer&&n.pointer.removeListeners(),n.cameraCtrl&&n.cameraCtrl.dispose(),n.renderer&&n.renderer.dispose()}function I(){var h;if(t.resize==="window")B(window.innerWidth,window.innerHeight);else{const l=n.renderer.domElement.parentNode;l&&B(l.clientWidth,l.clientHeight)}(h=t.onResize)==null||h.call(t,r)}function B(h,l){r.width=h,r.height=l,r.ratio=h/l,n.renderer.setSize(h,l,!1);const m=n.camera;if(m.type==="PerspectiveCamera"){const w=m;w.aspect=r.ratio,w.updateProjectionMatrix()}if(m.type==="OrthographicCamera"){const w=m;r.wWidth=w.right-w.left,r.wHeight=w.top-w.bottom}else{const w=Z();r.wWidth=w[0],r.wHeight=w[1]}}function Z(){const h=n.camera,l=h.fov*Math.PI/180,m=2*Math.tan(l/2)*Math.abs(h.position.z);return[m*h.aspect,m]}}const z=Symbol("Renderer");var it=a({name:"Renderer",props:{params:{type:Object,default:()=>({})},antialias:Boolean,alpha:Boolean,autoClear:{type:Boolean,default:!0},orbitCtrl:{type:[Boolean,Object],default:!1},pointer:{type:[Boolean,Object],default:!1},resize:{type:[Boolean,String],default:!1},shadow:Boolean,width:String,height:String,pixelRatio:Number,xr:Boolean,props:{type:Object,default:()=>({})},onReady:Function},inheritAttrs:!1,setup(e,{attrs:t}){const r=[],s=[],i=[],o=[],n=[],d=document.createElement("canvas");Object.entries(t).forEach(([A,U])=>{const T=A.match(/^on([A-Z][a-zA-Z]*)$/);T?d.addEventListener(T[1].toLowerCase(),U):d.setAttribute(A,U)});const x={canvas:d,params:e.params,antialias:e.antialias,alpha:e.alpha,autoClear:e.autoClear,orbitCtrl:e.orbitCtrl,pointer:e.pointer,resize:e.resize};e.width&&(x.width=parseInt(e.width)),e.height&&(x.height=parseInt(e.height));const R=oo(x);H(e,"props",R.renderer),vs(()=>{e.pixelRatio&&R.renderer.setPixelRatio(e.pixelRatio)});const S=()=>{};return{canvas:d,three:R,renderer:R.renderer,size:R.size,renderFn:S,raf:!0,initCallbacks:r,mountedCallbacks:s,beforeRenderCallbacks:i,afterRenderCallbacks:o,resizeCallbacks:n}},computed:{camera:{get:function(){return this.three.camera},set:function(e){this.three.camera=e}},scene:{get:function(){return this.three.scene},set:function(e){this.three.scene=e}},composer:{get:function(){return this.three.composer},set:function(e){this.three.composer=e}}},provide(){return{[z]:this}},mounted(){var e;this.$el.parentNode.insertBefore(this.canvas,this.$el),this.three.init()&&(this.three.pointer&&(this.$pointer=this.three.pointer),this.three.config.onResize=t=>{this.resizeCallbacks.forEach(r=>r({type:"resize",renderer:this,size:t}))},this.shadow&&(this.renderer.shadowMap.enabled=!0),this.renderFn=this.three.composer?this.three.renderC:this.three.render,this.initCallbacks.forEach(t=>t({type:"init",renderer:this})),(e=this.onReady)==null||e.call(this,this),this.xr?(this.renderer.xr.enabled=!0,this.renderer.setAnimationLoop(this.render)):requestAnimationFrame(this.renderLoop)),this.mountedCallbacks.forEach(t=>t({type:"mounted",renderer:this}))},beforeUnmount(){this.canvas.remove(),this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[],this.raf=!1,this.three.dispose()},methods:{onInit(e){this.addListener("init",e)},onMounted(e){this.addListener("mounted",e)},onBeforeRender(e){this.addListener("beforerender",e)},offBeforeRender(e){this.removeListener("beforerender",e)},onAfterRender(e){this.addListener("afterrender",e)},offAfterRender(e){this.removeListener("afterrender",e)},onResize(e){this.addListener("resize",e)},offResize(e){this.removeListener("resize",e)},addListener(e,t){this.getCallbacks(e).push(t)},removeListener(e,t){const r=this.getCallbacks(e),s=r.indexOf(t);s!==-1&&r.splice(s,1)},getCallbacks(e){return e==="init"?this.initCallbacks:e==="mounted"?this.mountedCallbacks:e==="beforerender"?this.beforeRenderCallbacks:e==="afterrender"?this.afterRenderCallbacks:this.resizeCallbacks},render(e){this.beforeRenderCallbacks.forEach(t=>t({type:"beforerender",renderer:this,time:e})),this.renderFn({renderer:this,time:e}),this.afterRenderCallbacks.forEach(t=>t({type:"afterrender",renderer:this,time:e}))},renderLoop(e){this.raf&&requestAnimationFrame(this.renderLoop),this.render(e)}},render(){return this.$slots.default?this.$slots.default():[]},__hmrId:"Renderer"}),ot=a({props:{props:{type:Object,default:()=>({})}},render(){return this.$slots.default?this.$slots.default():[]}});function ge(e,t,r,s=!0){e[t]=r,s&&e.updateProjectionMatrix()}var nt=a({extends:ot,name:"OrthographicCamera",props:{left:{type:Number,default:-1},right:{type:Number,default:1},top:{type:Number,default:1},bottom:{type:Number,default:-1},near:{type:Number,default:.1},far:{type:Number,default:2e3},zoom:{type:Number,default:1},position:{type:Object,default:()=>({x:0,y:0,z:0})}},setup(e){const t=q(z);if(!t){console.error("Renderer not found");return}const r=new Ts(e.left,e.right,e.top,e.bottom,e.near,e.far);return t.camera=r,g(e,"position",r),H(e,"props",r,!0,ge),["left","right","top","bottom","near","far","zoom"].forEach(s=>{c(()=>e[s],i=>{ge(r,s,i)})}),{renderer:t,camera:r}},__hmrId:"OrthographicCamera"}),be=a({extends:ot,name:"PerspectiveCamera",props:{aspect:{type:Number,default:1},far:{type:Number,default:2e3},fov:{type:Number,default:50},near:{type:Number,default:.1},position:{type:Object,default:()=>({x:0,y:0,z:0})},lookAt:{type:Object,default:null}},setup(e){var t;const r=q(z);if(!r){console.error("Renderer not found");return}const s=new Os(e.fov,e.aspect,e.near,e.far);return r.camera=s,g(e,"position",s),e.lookAt&&s.lookAt((t=e.lookAt.x)!=null?t:0,e.lookAt.y,e.lookAt.z),c(()=>e.lookAt,i=>{var o;s.lookAt((o=i.x)!=null?o:0,i.y,i.z)},{deep:!0}),H(e,"props",s,!0,ge),["aspect","far","fov","near"].forEach(i=>{c(()=>e[i],o=>{ge(s,i,o)})}),{renderer:r,camera:s}},__hmrId:"PerspectiveCamera"});const ve=Symbol("Scene");var at=a({name:"Scene",props:{background:[String,Number,Object]},setup(e){const t=q(z),r=new Rs;if(!t){console.error("Renderer not found");return}t.scene=r,_s(ve,r);const s=i=>{i&&(typeof i=="string"||typeof i=="number"?r.background instanceof he?r.background.set(i):r.background=new he(i):i instanceof Ds&&(r.background=i))};return s(e.background),c(()=>e.background,s),{scene:r,add:i=>{r.add(i)},remove:i=>{r.remove(i)}}},render(){return this.$slots.default?this.$slots.default():[]},__hmrId:"Scene"});const no={onPointerEnter:Function,onPointerOver:Function,onPointerMove:Function,onPointerLeave:Function,onPointerDown:Function,onPointerUp:Function,onClick:Function};var $=a({name:"Object3D",inject:{renderer:z,scene:ve},emits:["created","ready"],props:{position:{type:Object,default:()=>({x:0,y:0,z:0})},rotation:{type:Object,default:()=>({x:0,y:0,z:0})},scale:{type:Object,default:()=>({x:1,y:1,z:1,order:"XYZ"})},lookAt:{type:Object,default:null},userData:{type:Object,default:()=>({})},visible:{type:Boolean,default:!0},props:{type:Object,default:()=>({})},disableAdd:{type:Boolean,default:!1},disableRemove:{type:Boolean,default:!1},...no},setup(){return{}},created(){this.renderer||console.error("Missing parent Renderer"),this.scene||console.error("Missing parent Scene")},unmounted(){this.disableRemove||this.removeFromParent(),this.o3d&&this.renderer&&this.renderer.three.removeIntersectObject(this.o3d)},methods:{initObject3D(e){var t;this.o3d=e,e.userData.component=this,(this.onPointerEnter||this.onPointerOver||this.onPointerMove||this.onPointerLeave||this.onPointerDown||this.onPointerUp||this.onClick)&&this.renderer&&this.renderer.three.addIntersectObject(e),g(this,"position",e),g(this,"rotation",e),g(this,"scale",e),g(this,"userData",e.userData),g(this,"visible",e),H(this,"props",e),this.$emit("created",e),this.lookAt&&e.lookAt((t=this.lookAt.x)!=null?t:0,this.lookAt.y,this.lookAt.z),c(()=>this.lookAt,r=>{var s;e.lookAt((s=r.x)!=null?s:0,r.y,r.z)},{deep:!0}),this.parent=this.getParent(),this.disableAdd||(this.addToParent()?this.$emit("ready",this):console.error("Missing parent (Scene, Group...)"))},getParent(){let e=this.$parent;if(!e){const t=Ps();t&&t.parent&&(e=t.parent.ctx)}for(;e;){if(e.add)return e;e=e.$parent}},addToParent(e){const t=e||this.o3d;return this.parent?(this.parent.add(t),!0):!1},removeFromParent(e){const t=e||this.o3d;return this.parent?(this.parent.remove(t),!0):!1},add(e){var t;(t=this.o3d)==null||t.add(e)},remove(e){var t;(t=this.o3d)==null||t.remove(e)}},render(){return this.$slots.default?this.$slots.default():[]},__hmrId:"Object3D"}),ht=a({name:"Group",extends:$,setup(){return{group:new Ns}},created(){this.initObject3D(this.group)},__hmrId:"Group"});const V=()=>{};var lt=a({name:"Raycaster",props:{onPointerEnter:{type:Function,default:V},onPointerOver:{type:Function,default:V},onPointerMove:{type:Function,default:V},onPointerLeave:{type:Function,default:V},onPointerUp:{type:Function,default:V},onPointerDown:{type:Function,default:V},onClick:{type:Function,default:V},intersectMode:{type:String,default:"move"},intersectRecursive:{type:Boolean,default:!1}},setup(){return{renderer:q(z)}},mounted(){if(!this.renderer){console.error("Renderer not found");return}const e=this.renderer;this.renderer.onMounted(()=>{e.camera&&(this.pointer=st({camera:e.camera,domElement:e.canvas,intersectObjects:()=>e.scene?e.scene.children:[],intersectRecursive:this.intersectRecursive,onIntersectEnter:this.onPointerEnter,onIntersectOver:this.onPointerOver,onIntersectMove:this.onPointerMove,onIntersectLeave:this.onPointerLeave,onIntersectUp:this.onPointerUp,onIntersectDown:this.onPointerDown,onIntersectClick:this.onClick}),this.pointer.addListeners(),this.intersectMode==="frame"&&e.onBeforeRender(this.pointer.intersect))})},unmounted(){var e;this.pointer&&(this.pointer.removeListeners(),(e=this.renderer)==null||e.offBeforeRender(this.pointer.intersect))},render(){return[]},__hmrId:"Raycaster"}),dt=a({extends:$,props:{cubeRTSize:{type:Number,default:256},cubeCameraNear:{type:Number,default:.1},cubeCameraFar:{type:Number,default:2e3},autoUpdate:Boolean,hideMeshes:{type:Array,default:()=>[]}},setup(e){const t=q(z);if(!t||!t.scene)return console.error("Missing Renderer / Scene"),{};const r=t.renderer,s=t.scene,i=new js(e.cubeRTSize,{format:Gs,generateMipmaps:!0,minFilter:ks}),o=new As(e.cubeCameraNear,e.cubeCameraFar,i),n=()=>{e.hideMeshes.forEach(d=>{d.visible=!1}),o.update(r,s),e.hideMeshes.forEach(d=>{d.visible=!0})};return e.autoUpdate?(t.onBeforeRender(n),Ss(()=>{t.offBeforeRender(n)})):t.onMounted(n),{cubeRT:i,cubeCamera:o,updateRT:n}},created(){this.cubeCamera&&this.initObject3D(this.cubeCamera)},render(){return[]},__hmrId:"CubeCamera"});const se=Symbol("Mesh"),W=a({name:"Mesh",extends:$,props:{castShadow:Boolean,receiveShadow:Boolean},setup(){return{}},provide(){return{[se]:this}},mounted(){!this.mesh&&!this.loading&&this.initMesh()},methods:{initMesh(){const e=new zs(this.geometry,this.material);g(this,"castShadow",e),g(this,"receiveShadow",e),this.mesh=e,this.initObject3D(e)},createGeometry(){},addGeometryWatchers(e){Object.keys(e).forEach(t=>{c(()=>this[t],()=>{this.refreshGeometry()})})},setGeometry(e){this.geometry=e,this.mesh&&(this.mesh.geometry=e)},setMaterial(e){this.material=e,this.mesh&&(this.mesh.material=e)},refreshGeometry(){const e=this.geometry;this.createGeometry(),this.mesh&&this.geometry&&(this.mesh.geometry=this.geometry),e==null||e.dispose()}},unmounted(){this.geometry&&this.geometry.dispose(),this.material&&this.material.dispose()},__hmrId:"Mesh"});function O(e,t,r){return a({name:e,extends:W,props:t,created(){this.createGeometry(),this.addGeometryWatchers(t)},methods:{createGeometry(){this.geometry=r(this)}}})}const _e=a({emits:["created"],props:{rotateX:Number,rotateY:Number,rotateZ:Number,attributes:{type:Array,default:()=>[]}},inject:{mesh:se},setup(){return{}},created(){if(!this.mesh){console.error("Missing parent Mesh");return}this.createGeometry(),this.rotateGeometry(),this.geometry&&this.mesh.setGeometry(this.geometry),Object.keys(this.$props).forEach(e=>{c(()=>this[e],this.refreshGeometry)})},unmounted(){var e;(e=this.geometry)==null||e.dispose()},methods:{createGeometry(){const e={},t=new Is;this.attributes.forEach(r=>{if(r.name&&r.itemSize&&r.array){const s=e[r.name]=new $s(r.array,r.itemSize,r.normalized);t.setAttribute(r.name,s)}}),t.computeBoundingBox(),t.userData.component=this,this.geometry=t,this.$emit("created",t)},rotateGeometry(){this.geometry&&(this.rotateX&&this.geometry.rotateX(this.rotateX),this.rotateY&&this.geometry.rotateY(this.rotateY),this.rotateZ&&this.geometry.rotateZ(this.rotateZ))},refreshGeometry(){const e=this.geometry;this.createGeometry(),this.rotateGeometry(),this.geometry&&this.mesh&&this.mesh.setGeometry(this.geometry),e==null||e.dispose()}},render(){return[]}});function M(e,t,r){return a({name:e,extends:_e,props:t,methods:{createGeometry(){this.geometry=r(this),this.geometry.userData.component=this,this.$emit("created",this.geometry)}}})}const ct={size:Number,width:{type:Number,default:1},height:{type:Number,default:1},depth:{type:Number,default:1},widthSegments:{type:Number,default:1},heightSegments:{type:Number,default:1},depthSegments:{type:Number,default:1}};function ut(e){return e.size?new Le(e.size,e.size,e.size,e.widthSegments,e.heightSegments,e.depthSegments):new Le(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}var pt=M("BoxGeometry",ct,ut);const mt={radius:{type:Number,default:1},segments:{type:Number,default:8},thetaStart:{type:Number,default:0},thetaLength:{type:Number,default:Math.PI*2}};function ft(e){return new Fs(e.radius,e.segments,e.thetaStart,e.thetaLength)}var yt=M("CircleGeometry",mt,ft);const gt={radius:{type:Number,default:1},height:{type:Number,default:1},radialSegments:{type:Number,default:8},heightSegments:{type:Number,default:1},openEnded:{type:Boolean,default:!1},thetaStart:{type:Number,default:0},thetaLength:{type:Number,default:Math.PI*2}};function bt(e){return new Us(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}var vt=M("ConeGeometry",gt,bt);const _t={radiusTop:{type:Number,default:1},radiusBottom:{type:Number,default:1},height:{type:Number,default:1},radialSegments:{type:Number,default:8},heightSegments:{type:Number,default:1},openEnded:{type:Boolean,default:!1},thetaStart:{type:Number,default:0},thetaLength:{type:Number,default:Math.PI*2}};function Pt(e){return new Bs(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}var St=M("CylinderGeometry",_t,Pt);const wt={radius:{type:Number,default:1},detail:{type:Number,default:0}};function Mt(e){return new Hs(e.radius,e.detail)}var xt=M("DodecahedronGeometry",wt,Mt);const ao={shapes:{type:[Object,Array]},options:{type:Object},positions:{type:Array,default:null},rotations:{type:Array,default:null}};function ho(e){if(Array.isArray(e.options)&&Array.isArray(e.shapes))if(e.shapes.length>0){const t=e.shapes.map((r,s)=>{const i=new Ye(r,e.options[s]);return e.rotations&&(e.rotations[s].x!=0&&i.rotateX(e.rotations[s].x),e.rotations[s].y!=0&&i.rotateY(e.rotations[s].y),e.rotations[s].z!=0&&i.rotateZ(e.rotations[s].z)),e.positions&&i.translate(e.positions[s].x,e.positions[s].y,e.positions[s].z),i});return Mi(t)}else{console.warn("Empty shape array found in ExtrudeGeometry");const t=new Le(.001,.001,.001);return t.translate(-1e3,-1e3,-1e3),t}else return new Ye(e.shapes,e.options)}var Et=M("ExtrudeGeometry",ao,ho);const Lt={radius:{type:Number,default:1},detail:{type:Number,default:0}};function Ct(e){return new Ys(e.radius,e.detail)}var Tt=M("IcosahedronGeometry",Lt,Ct);const Ot={points:Array,segments:{type:Number,default:12},phiStart:{type:Number,default:0},phiLength:{type:Number,default:Math.PI*2}};function Rt(e){return new Ks(e.points,e.segments,e.phiStart,e.phiLength)}var Dt=M("LatheGeometry",Ot,Rt);const Nt={radius:{type:Number,default:1},detail:{type:Number,default:0}};function jt(e){return new Zs(e.radius,e.detail)}var Gt=M("OctahedronGeometry",Nt,jt);const kt={width:{type:Number,default:1},height:{type:Number,default:1},widthSegments:{type:Number,default:1},heightSegments:{type:Number,default:1}};function At(e){return new Ke(e.width,e.height,e.widthSegments,e.heightSegments)}var zt=M("PlaneGeometry",kt,At);const It={vertices:Array,indices:Array,radius:{type:Number,default:1},detail:{type:Number,default:0}};function $t(e){return new Xs(e.vertices,e.indices,e.radius,e.detail)}var Ft=M("PolyhedronGeometry",It,$t);const Ut={innerRadius:{type:Number,default:.5},outerRadius:{type:Number,default:1},thetaSegments:{type:Number,default:8},phiSegments:{type:Number,default:1},thetaStart:{type:Number,default:0},thetaLength:{type:Number,default:Math.PI*2}};function Bt(e){return new Vs(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}var Ht=M("RingGeometry",Ut,Bt);const Yt={radius:{type:Number,default:1},widthSegments:{type:Number,default:12},heightSegments:{type:Number,default:12},phiStart:{type:Number,default:0},phiLength:{type:Number,default:Math.PI*2},thetaStart:{type:Number,default:0},thetaLength:{type:Number,default:Math.PI}};function Kt(e){return new Ws(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}var Zt=M("SphereGeometry",Yt,Kt);const lo={shapes:{type:[Object,Array]},curveSegments:{type:Number}};function co(e){return new qs(e.shapes,e.curveSegments)}var Xt=M("ShapeGeometry",lo,co);const Vt={radius:{type:Number,default:1},detail:{type:Number,default:0}};function Wt(e){return new Qs(e.radius,e.detail)}var qt=M("TetrahedronGeometry",Vt,Wt);const Qt={radius:{type:Number,default:1},tube:{type:Number,default:.4},radialSegments:{type:Number,default:8},tubularSegments:{type:Number,default:6},arc:{type:Number,default:Math.PI*2}};function Jt(e){return new Js(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}var er=M("TorusGeometry",Qt,Jt);const tr={radius:{type:Number,default:1},tube:{type:Number,default:.4},tubularSegments:{type:Number,default:64},radialSegments:{type:Number,default:8},p:{type:Number,default:2},q:{type:Number,default:3}};function rr(e){return new ei(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}var sr=M("TorusKnotGeometry",tr,rr);const je={points:Array,path:ti,tubularSegments:{type:Number,default:64},radius:{type:Number,default:1},radialSegments:{type:Number,default:8},closed:{type:Boolean,default:!1}};function ir(e){let t;return e.points?t=new Ze(e.points):e.path?t=e.path:console.error("Missing path curve or points."),new ri(t,e.tubularSegments,e.radius,e.radiusSegments,e.closed)}var or=a({extends:_e,props:je,methods:{createGeometry(){this.geometry=ir(this)},updatePoints(e){nr(this.geometry,e)}}});function nr(e,t){const r=new Ze(t),{radialSegments:s,radius:i,tubularSegments:o,closed:n}=e.parameters,d=r.computeFrenetFrames(o,n);e.tangents=d.tangents,e.normals=d.normals,e.binormals=d.binormals,e.parameters.path=r;const x=e.getAttribute("position"),R=e.getAttribute("normal"),S=new j,A=new j;for(let T=0;T<o;T++)U(T);U(o),e.attributes.position.needsUpdate=!0,e.attributes.normal.needsUpdate=!0;function U(T){r.getPointAt(T/o,A);const Y=d.normals[T],K=d.binormals[T];for(let I=0;I<=s;I++){const B=I/s*Math.PI*2,Z=Math.sin(B),h=-Math.cos(B);S.x=h*Y.x+Z*K.x,S.y=h*Y.y+Z*K.y,S.z=h*Y.z+Z*K.z,S.normalize();const l=T*(s+1)+I;R.setXYZ(l,S.x,S.y,S.z),x.setXYZ(l,A.x+i*S.x,A.y+i*S.y,A.z+i*S.z)}}}var ie=a({extends:$,name:"Light",props:{color:{type:String,default:"#ffffff"},intensity:{type:Number,default:1},castShadow:{type:Boolean,default:!1},shadowMapSize:{type:Object,default:()=>({x:512,y:512})},shadowCamera:{type:Object,default:()=>({})}},setup(){return{}},unmounted(){(this.light instanceof Ce||this.light instanceof Te)&&this.removeFromParent(this.light.target)},methods:{initLight(e){this.light=e,e.shadow&&(e.castShadow=this.castShadow,re(e.shadow.mapSize,this.shadowMapSize),re(e.shadow.camera,this.shadowCamera)),["color","intensity","castShadow"].forEach(t=>{c(()=>this[t],r=>{t==="color"?e.color.set(r):e[t]=r})}),this.initObject3D(e),(e instanceof Ce||e instanceof Te)&&(g(this,"target",e.target,"position"),this.addToParent(e.target))}},__hmrId:"Light"}),ar=a({extends:ie,created(){this.initLight(new si(this.color,this.intensity))},__hmrId:"AmbientLight"}),hr=a({extends:ie,props:{target:{type:Object,default:()=>({x:0,y:0,z:0})}},created(){this.initLight(new Te(this.color,this.intensity))},__hmrId:"DirectionalLight"}),lr=a({extends:ie,props:{groundColor:{type:String,default:"#444444"}},created(){const e=new ii(this.color,this.groundColor,this.intensity);c(()=>this.groundColor,t=>{e.groundColor.set(t)}),this.initLight(e)},__hmrId:"HemisphereLight"}),dr=a({extends:ie,props:{distance:{type:Number,default:0},decay:{type:Number,default:1}},created(){this.initLight(new oi(this.color,this.intensity,this.distance,this.decay))},__hmrId:"PointLight"}),cr=a({extends:ie,props:{width:{type:Number,default:10},height:{type:Number,default:10},helper:Boolean},created(){xi.init();const e=new ni(this.color,this.intensity,this.width,this.height);if(["width","height"].forEach(t=>{c(()=>this[t],r=>{e[t]=r})}),this.helper){const t=new Ei(e);e.add(t)}this.initLight(e)},__hmrId:"RectAreaLight"}),ur=a({extends:ie,props:{angle:{type:Number,default:Math.PI/3},decay:{type:Number,default:1},distance:{type:Number,default:0},penumbra:{type:Number,default:0},target:Object},created(){const e=new Ce(this.color,this.intensity,this.distance,this.angle,this.penumbra,this.decay);["angle","decay","distance","penumbra"].forEach(t=>{c(()=>this[t],r=>{e[t]=r})}),this.initLight(e)},__hmrId:"SpotLight"});const Pe=Symbol("Material"),Se=a({emits:["created"],props:{color:{type:String,default:"#ffffff"},props:{type:Object,default:()=>({})}},inject:{mesh:se},setup(){return{}},provide(){return{[Pe]:this}},created(){if(!this.mesh){console.error("Missing parent Mesh");return}if(this.createMaterial){const e=this.material=this.createMaterial();c(()=>this.color,t=>{e.color.set(t)}),H(this,"props",e,!1,this.setProp),this.$emit("created",e),this.mesh.setMaterial(e)}},unmounted(){var e;(e=this.material)==null||e.dispose()},methods:{getMaterialParams(){return{...de(this.$props,["props"]),...this.props}},setProp(e,t,r,s=!1){const i=e[t];i instanceof he?i.set(r):e[t]=r,e.needsUpdate=s},setTexture(e,t="map"){this.setProp(this.material,t,e,!0)}},render(){return this.$slots.default?this.$slots.default():[]},__hmrId:"Material"});function F(e,t,r){return a({name:e,extends:Se,props:t,methods:{createMaterial(){return r(this.getMaterialParams())}}})}const pr=F("BasicMaterial",{props:{type:Object,default:()=>({})}},e=>new Xe(e)),mr=F("LambertMaterial",{props:{type:Object,default:()=>({})}},e=>new ai(e)),fr=F("PhongMaterial",{props:{type:Object,default:()=>({})}},e=>new hi(e)),yr=F("PhysicalMaterial",{props:{type:Object,default:()=>({})}},e=>new li(e)),gr=F("PointsMaterial",{props:{type:Object,default:()=>({})}},e=>new di(e)),br=F("ShadowMaterial",{color:{type:String,default:"#000000"},props:{type:Object,default:()=>({})}},e=>new ci(e)),vr=F("StandardMaterial",{props:{type:Object,default:()=>({})}},e=>new ui(e)),_r=F("ToonMaterial",{props:{type:Object,default:()=>({})}},e=>new pi(e));var Pr=F("MatcapMaterial",{src:String,name:{type:String,default:"0404E8_0404B5_0404CB_3333FC"}},e=>{const t=e.src?e.src:Re(e.name),r=de(e,["src","name"]);return r.matcap=new le().load(t),new mi(r)});const uo=`
  varying vec2 vUv;
  void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
  }
`,po=`
  varying vec2 vUv;
  void main() {
    gl_FragColor = vec4(vUv.x, vUv.y, 0., 1.0);
  }
`;var Sr=F("ShaderMaterial",{props:{type:Object,default:()=>({uniforms:{},vertexShader:uo,fragmentShader:po})}},e=>new Oe(de(e,["color"])));function mo(e,t,r){return e.split(t).join(r)}const fo=ee.meshphong_frag.slice(0,ee.meshphong_frag.indexOf("void main() {")),yo=ee.meshphong_frag.slice(ee.meshphong_frag.indexOf("void main() {")),go={uniforms:Ve.merge([fi.phong.uniforms,{thicknessColor:{value:new he(16777215)},thicknessDistortion:{value:.1},thicknessAmbient:{value:0},thicknessAttenuation:{value:.1},thicknessPower:{value:2},thicknessScale:{value:10}}]),vertexShader:`
    #define USE_UV
    ${ee.meshphong_vert}
  `,fragmentShader:`
    #define USE_UV
    #define SUBSURFACE

    ${fo}

    uniform float thicknessPower;
    uniform float thicknessScale;
    uniform float thicknessDistortion;
    uniform float thicknessAmbient;
    uniform float thicknessAttenuation;
    uniform vec3 thicknessColor;

    void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in GeometricContext geometry, inout ReflectedLight reflectedLight) {
      #ifdef USE_COLOR
        vec3 thickness = vColor * thicknessColor;
      #else
        vec3 thickness = thicknessColor;
      #endif
      vec3 scatteringHalf = normalize(directLight.direction + (geometry.normal * thicknessDistortion));
      float scatteringDot = pow(saturate(dot(geometry.viewDir, -scatteringHalf)), thicknessPower) * thicknessScale;
      vec3 scatteringIllu = (scatteringDot + thicknessAmbient) * thickness;
      reflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;
    }
  `+yo.replace("#include <lights_fragment_begin>",mo(ee.lights_fragment_begin,"RE_Direct( directLight, geometry, material, reflectedLight );",`
        RE_Direct( directLight, geometry, material, reflectedLight );
        #if defined( SUBSURFACE ) && defined( USE_UV )
          RE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);
        #endif
      `))};var wr=a({extends:Se,props:{uniforms:{type:Object,default:()=>({diffuse:"#ffffff",thicknessColor:"#ffffff",thicknessDistortion:.4,thicknessAmbient:.01,thicknessAttenuation:.7,thicknessPower:2,thicknessScale:4})}},methods:{createMaterial(){const e=go,t=Ve.clone(e.uniforms);return H(this,"uniforms",t,!0,(r,s,i)=>{const o=r[s].value;o instanceof he?o.set(i):r[s].value=i}),new Oe({...e,lights:!0,...this.props,uniforms:t})}}}),we=a({inject:{material:Pe},props:{name:{type:String,default:"map"},uniform:String,src:String,onLoad:Function,onProgress:Function,onError:Function,props:{type:Object,default:()=>({})}},setup(){return{}},created(){this.refreshTexture(),c(()=>this.src,this.refreshTexture)},unmounted(){var e,t;(e=this.material)==null||e.setTexture(null,this.name),(t=this.texture)==null||t.dispose()},methods:{createTexture(){if(this.src)return new le().load(this.src,this.onLoaded,this.onProgress,this.onError)},initTexture(){this.texture&&(H(this,"props",this.texture),this.material&&(this.material.setTexture(this.texture,this.name),this.material.material instanceof Oe&&this.uniform&&(this.material.material.uniforms[this.uniform]={value:this.texture})))},refreshTexture(){var e;(e=this.texture)==null||e.dispose(),this.texture=this.createTexture(),this.initTexture()},onLoaded(e){var t;(t=this.onLoad)==null||t.call(this,e)}},render(){return[]}}),Mr=a({extends:we,props:{name:{type:String,default:"envMap"},path:{type:String,required:!0},urls:{type:Array,default:()=>["px.jpg","nx.jpg","py.jpg","ny.jpg","pz.jpg","nz.jpg"]},props:{type:Object,default:()=>({mapping:yi})}},created(){c(()=>this.path,this.refreshTexture),c(()=>this.urls,this.refreshTexture)},methods:{createTexture(){return new gi().setPath(this.path).load(this.urls,this.onLoaded,this.onProgress,this.onError)}}}),xr=a({extends:we,props:{videoId:{type:String,required:!0}},created(){c(()=>this.videoId,this.refreshTexture)},methods:{createTexture(){const e=document.getElementById(this.videoId);return new bi(e)}}}),Er=O("Box",ct,ut),Lr=O("Circle",mt,ft),Cr=O("Cone",gt,bt),Tr=O("Cylinder",_t,Pt),Or=O("Dodecahedron",wt,Mt),Rr=O("Icosahedron",Lt,Ct),Dr=O("Lathe",Ot,Rt),Nr=O("Octahedron",Nt,jt),jr=O("Plane",kt,At),Gr=O("Polyhedron",It,$t),kr=O("Ring",Ut,Bt),Ar=O("Sphere",Yt,Kt),zr=O("Tetrahedron",Vt,Wt);const bo={text:{type:String,required:!0,default:"Text"},fontSrc:{type:String,required:!0},size:{type:Number,default:80},height:{type:Number,default:5},depth:{type:Number,default:1},curveSegments:{type:Number,default:12},bevelEnabled:{type:Boolean,default:!1},bevelThickness:{type:Number,default:10},bevelSize:{type:Number,default:8},bevelOffset:{type:Number,default:0},bevelSegments:{type:Number,default:5},align:{type:[Boolean,String],default:!1}};var Ir=a({extends:W,props:bo,setup(){return{}},created(){if(!this.fontSrc){console.error('Missing required prop: "font-src"');return}["text","size","height","curveSegments","bevelEnabled","bevelThickness","bevelSize","bevelOffset","bevelSegments","align"].forEach(t=>{c(()=>this[t],()=>{this.font&&this.refreshGeometry()})});const e=new Ci;this.loading=!0,e.load(this.fontSrc,t=>{this.loading=!1,this.font=t,this.createGeometry(),this.initMesh()})},methods:{createGeometry(){this.geometry=new Li(this.text,{font:this.font,size:this.size,height:this.height,depth:this.depth,curveSegments:this.curveSegments,bevelEnabled:this.bevelEnabled,bevelThickness:this.bevelThickness,bevelSize:this.bevelSize,bevelOffset:this.bevelOffset,bevelSegments:this.bevelSegments}),this.align==="center"&&this.geometry.center()}}}),$r=O("Torus",Qt,Jt),Fr=O("TorusKnot",tr,rr),Ur=a({extends:W,props:je,created(){this.createGeometry(),this.addGeometryWatchers(je)},methods:{createGeometry(){this.geometry=ir(this)},updatePoints(e){nr(this.geometry,e)}},__hmrId:"Tube"}),Br=a({emits:["loaded"],extends:W,props:{src:{type:String,required:!0},width:Number,height:Number,widthSegments:{type:Number,default:1},heightSegments:{type:Number,default:1},keepSize:Boolean},setup(){return{}},created(){this.renderer&&(this.geometry=new Ke(1,1,this.widthSegments,this.heightSegments),this.material=new Xe({side:vi,map:this.loadTexture()}),c(()=>this.src,this.refreshTexture),["width","height"].forEach(e=>{c(()=>this[e],this.resize)}),this.resize(),this.keepSize&&this.renderer.onResize(this.resize))},unmounted(){var e;(e=this.renderer)==null||e.offResize(this.resize)},methods:{loadTexture(){return new le().load(this.src,this.onLoaded)},refreshTexture(){var e;(e=this.texture)==null||e.dispose(),this.material&&(this.material.map=this.loadTexture(),this.material.needsUpdate=!0)},onLoaded(e){this.texture=e,this.resize(),this.$emit("loaded",e)},resize(){if(!this.renderer||!this.texture)return;const e=this.renderer.size,t=this.texture.image.width,r=this.texture.image.height,s=t/r;let i=1,o=1;this.width&&this.height?(i=this.width*e.wWidth/e.width,o=this.height*e.wHeight/e.height):this.width?(i=this.width*e.wWidth/e.width,o=i/s):this.height?(o=this.height*e.wHeight/e.height,i=o*s):s>1?i=o*s:o=i/s,this.mesh&&(this.mesh.scale.x=i,this.mesh.scale.y=o)}},__hmrId:"Image"}),Hr=a({extends:W,props:{count:{type:Number,required:!0}},methods:{initMesh(){if(this.renderer){if(!this.geometry||!this.material)return console.error("Missing geometry and/or material"),!1;this.mesh=new ae(this.geometry,this.material,this.count),this.mesh.userData.component=this,g(this,"castShadow",this.mesh),g(this,"receiveShadow",this.mesh),(this.onPointerEnter||this.onPointerOver||this.onPointerMove||this.onPointerLeave||this.onPointerDown||this.onPointerUp||this.onClick)&&this.renderer.three.addIntersectObject(this.mesh),this.initObject3D(this.mesh)}}},__hmrId:"InstancedMesh"}),Yr=a({extends:$,emits:["loaded"],props:{src:{type:String,required:!0}},setup(){return{}},created(){this.texture=new le().load(this.src,this.onLoaded),this.material=new _i({map:this.texture}),this.sprite=new Pi(this.material),this.initObject3D(this.sprite)},unmounted(){var e,t;(e=this.texture)==null||e.dispose(),(t=this.material)==null||t.dispose()},methods:{onLoaded(){this.updateUV(),this.$emit("loaded")},updateUV(){if(!this.texture||!this.sprite)return;const e=this.texture.image.width,t=this.texture.image.height,r=e/t;let s=.5,i=.5;r>1?s=.5*r:i=.5/r;const o=this.sprite.geometry.attributes.position.array;o[0]=-s,o[1]=-i,o[5]=s,o[6]=-i,o[10]=s,o[11]=i,o[15]=-s,o[16]=i,this.sprite.geometry.attributes.position.needsUpdate=!0}},__hmrId:"Sprite"}),Kr=a({extends:$,setup(){return{}},provide(){return{[se]:this}},mounted(){this.mesh=this.points=new Si(this.geometry,this.material),this.initObject3D(this.mesh)},methods:{setGeometry(e){this.geometry=e,this.mesh&&(this.mesh.geometry=e)},setMaterial(e){this.material=e,this.mesh&&(this.mesh.material=e)}}}),Zr=a({extends:$,emits:["before-load","load","progress","error"],props:{src:{type:String,required:!0}},data(){return{progress:0}},methods:{onLoad(e){this.$emit("load",e)},onProgress(e){this.progress=e.loaded/e.total,this.$emit("progress",e)},onError(e){this.$emit("error",e)}}}),Xr=a({extends:Zr,created(){const e=new Ti;this.$emit("before-load",e),e.load(this.src,t=>{this.onLoad(t),this.initObject3D(t.scene)},this.onProgress,this.onError)}}),Vr=a({extends:Zr,created(){const e=new Oi;this.$emit("before-load",e),e.load(this.src,t=>{this.onLoad(t),this.initObject3D(t)},this.onProgress,this.onError)}});const Me=Symbol("Composer");var Wr=a({setup(){return{renderer:q(z)}},provide(){return{[Me]:this}},created(){if(!this.renderer){console.error("Renderer not found");return}const e=this.renderer,t=new Ri(this.renderer.renderer);this.composer=t,this.renderer.composer=t,e.addListener("init",()=>{e.renderer.autoClear=!1,this.resize(),e.addListener("resize",this.resize)})},unmounted(){var e;(e=this.renderer)==null||e.removeListener("resize",this.resize)},methods:{addPass(e){var t;(t=this.composer)==null||t.addPass(e)},removePass(e){var t;(t=this.composer)==null||t.removePass(e)},resize(){this.composer&&this.renderer&&this.composer.setSize(this.renderer.size.width,this.renderer.size.height)}},render(){return this.$slots.default?this.$slots.default():[]},__hmrId:"EffectComposer"}),k=a({inject:{renderer:z,composer:Me},emits:["ready"],setup(){return{}},created(){this.composer||console.error("Missing parent EffectComposer"),this.renderer||console.error("Missing parent Renderer")},unmounted(){var e,t,r;this.pass&&((e=this.composer)==null||e.removePass(this.pass),(r=(t=this.pass).dispose)==null||r.call(t))},methods:{initEffectPass(e){var t;this.pass=e,(t=this.composer)==null||t.addPass(e),this.$emit("ready",e)}},render(){return[]},__hmrId:"EffectPass"}),qr=a({extends:k,created(){if(!this.renderer)return;if(!this.renderer.scene){console.error("Missing Scene");return}if(!this.renderer.camera){console.error("Missing Camera");return}const e=new Di(this.renderer.scene,this.renderer.camera);this.initEffectPass(e)},__hmrId:"RenderPass"});const Qr={focus:{type:Number,default:1},aperture:{type:Number,default:.025},maxblur:{type:Number,default:.01}};var Jr=a({extends:k,props:Qr,created(){if(!this.renderer)return;if(!this.renderer.scene){console.error("Missing Scene");return}if(!this.renderer.camera){console.error("Missing Camera");return}const e={focus:this.focus,aperture:this.aperture,maxblur:this.maxblur,width:this.renderer.size.width,height:this.renderer.size.height},t=new Ni(this.renderer.scene,this.renderer.camera,e);Object.keys(Qr).forEach(r=>{c(()=>this[r],s=>{t.uniforms[r].value=s})}),this.initEffectPass(t)},__hmrId:"BokehPass"});const es={noiseIntensity:{type:Number,default:.5},scanlinesIntensity:{type:Number,default:.05},scanlinesCount:{type:Number,default:4096},grayscale:{type:Number,default:0}};var ts=a({extends:k,props:es,created(){const e=new ji(this.noiseIntensity,this.scanlinesIntensity,this.scanlinesCount,this.grayscale);Object.keys(es).forEach(t=>{c(()=>this[t],r=>{e.uniforms[t].value=r})}),this.initEffectPass(e)},__hmrId:"FilmPass"}),rs=a({extends:k,created(){var e;const t=new fe(Gi);(e=this.renderer)==null||e.addListener("resize",this.resize),this.initEffectPass(t)},unmounted(){var e;(e=this.renderer)==null||e.removeListener("resize",this.resize)},methods:{resize({size:e}){if(this.pass){const{resolution:t}=this.pass.material.uniforms;t.value.x=1/e.width,t.value.y=1/e.height}}},__hmrId:"FXAAPass"});const ss={shape:{type:Number,default:1},radius:{type:Number,default:4},rotateR:{type:Number,default:Math.PI/12*1},rotateG:{type:Number,default:Math.PI/12*2},rotateB:{type:Number,default:Math.PI/12*3},scatter:{type:Number,default:0}};var is=a({extends:k,props:ss,created(){if(!this.renderer)return;const e=new ki(this.renderer.size.width,this.renderer.size.height,{});Object.keys(ss).forEach(t=>{e.uniforms[t].value=this[t],c(()=>this[t],r=>{e.uniforms[t].value=r})}),this.initEffectPass(e)},__hmrId:"HalftonePass"}),os=a({extends:k,created(){if(!this.renderer)return;const e=new Ai(this.renderer.size.width,this.renderer.size.height);this.initEffectPass(e)},__hmrId:"SMAAPass"}),ns=a({extends:k,props:{options:{type:Object,default:()=>({})}},created(){if(!this.renderer)return;if(!this.renderer.scene){console.error("Missing Scene");return}if(!this.renderer.camera){console.error("Missing Camera");return}const e=new zi(this.renderer.scene,this.renderer.camera,this.renderer.size.width,this.renderer.size.height);Object.keys(this.options).forEach(t=>{e[t]=this.options[t]}),this.initEffectPass(e)},__hmrId:"SSAOPass"}),as={uniforms:{},vertexShader:`
    varying vec2 vUv;
    void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,fragmentShader:`
    varying vec2 vUv;
    void main() {
      gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
    }
  `},hs={uniforms:{tDiffuse:{value:null},blurRadius:{value:0},gradientRadius:{value:0},start:{value:new _},end:{value:new _},delta:{value:new _},texSize:{value:new _}},vertexShader:as.vertexShader,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float blurRadius;
    uniform float gradientRadius;
    uniform vec2 start;
    uniform vec2 end;
    uniform vec2 delta;
    uniform vec2 texSize;
    varying vec2 vUv;

    float random(vec3 scale, float seed) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
    }

    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;

      /* randomize the lookup values to hide the fixed number of samples */
      float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);

      vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
      float radius = smoothstep(0.0, 1.0, abs(dot(vUv * texSize - start, normal)) / gradientRadius) * blurRadius;
      for (float t = -30.0; t <= 30.0; t++) {
          float percent = (t + offset - 0.5) / 30.0;
          float weight = 1.0 - abs(percent);
          vec4 texel = texture2D(tDiffuse, vUv + delta / texSize * percent * radius);
          // vec4 texel2 = texture2D(tDiffuse, vUv + vec2(-delta.y, delta.x) / texSize * percent * radius);

          /* switch to pre-multiplied alpha to correctly blur transparent images */
          texel.rgb *= texel.a;
          // texel2.rgb *= texel2.a;

          color += texel * weight;
          total += 2.0 * weight;
      }

      gl_FragColor = color / total;

      /* switch back from pre-multiplied alpha */
      gl_FragColor.rgb /= gl_FragColor.a + 0.00001;
    }
  `};const vo={blurRadius:{type:Number,default:10},gradientRadius:{type:Number,default:100},start:{type:Object,default:()=>({x:0,y:100})},end:{type:Object,default:()=>({x:10,y:100})}};var ls=a({extends:k,props:vo,setup(){return{uniforms1:{},uniforms2:{}}},created(){if(!this.composer)return;this.pass1=new fe(hs),this.pass2=new fe(hs);const e=this.uniforms1=this.pass1.uniforms,t=this.uniforms2=this.pass2.uniforms;t.blurRadius=e.blurRadius,t.gradientRadius=e.gradientRadius,t.start=e.start,t.end=e.end,t.texSize=e.texSize,g(this,"blurRadius",e.blurRadius,"value"),g(this,"gradientRadius",e.gradientRadius,"value"),this.updateFocusLine(),["start","end"].forEach(r=>{c(()=>this[r],this.updateFocusLine,{deep:!0})}),this.pass1.setSize=(r,s)=>{e.texSize.value.set(r,s)},this.initEffectPass(this.pass1),this.composer.addPass(this.pass2)},unmounted(){this.composer&&this.pass2&&this.composer.removePass(this.pass2)},methods:{updateFocusLine(){this.uniforms1.start.value.copy(this.start),this.uniforms1.end.value.copy(this.end);const e=new _().copy(this.end).sub(this.start).normalize();this.uniforms1.delta.value.copy(e),this.uniforms2.delta.value.set(-e.y,e.x)}},__hmrId:"TiltShiftPass"});const ds={strength:{type:Number,default:1.5},radius:{type:Number,default:0},threshold:{type:Number,default:0}};var cs=a({extends:k,props:ds,created(){if(!this.renderer)return;const e=new _(this.renderer.size.width,this.renderer.size.height),t=new Ii(e,this.strength,this.radius,this.threshold);Object.keys(ds).forEach(r=>{c(()=>this[r],s=>{t.uniforms[r].value=s})}),this.initEffectPass(t)},__hmrId:"UnrealBloomPass"}),_o={uniforms:{tDiffuse:{value:null},center:{value:new _(.5,.5)},strength:{value:0}},vertexShader:as.vertexShader,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform vec2 center;
    uniform float strength;
    varying vec2 vUv;

    float random(vec3 scale, float seed) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
    }
    
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      vec2 toCenter = center - vUv;
      
      /* randomize the lookup values to hide the fixed number of samples */
      float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
      
      for (float t = 0.0; t <= 40.0; t++) {
        float percent = (t + offset) / 40.0;
        float weight = 4.0 * (percent - percent * percent);
        vec4 texel = texture2D(tDiffuse, vUv + toCenter * percent * strength);

        /* switch to pre-multiplied alpha to correctly blur transparent images */
        texel.rgb *= texel.a;

        color += texel * weight;
        total += weight;
      }

      gl_FragColor = color / total;

      /* switch back from pre-multiplied alpha */
      gl_FragColor.rgb /= gl_FragColor.a + 0.00001;
    }
  `},us=a({extends:k,props:{center:{type:Object,default:()=>({x:.5,y:.5})},strength:{type:Number,default:.5}},created(){const e=new fe(_o);g(this,"center",e.uniforms.center,"value"),g(this,"strength",e.uniforms.strength,"value"),this.initEffectPass(e)},__hmrId:"ZoomBlurPass"});const Po={size:{type:Number,required:!0,default:100},divisions:{type:Number,required:!0,default:10},color1:{type:Number},color2:{type:Number}};var ps=a({extends:$,name:"GridHelper",props:Po,setup(){return{}},mounted(){this.helper||this.initHelper(),["size","divisions","color1","color2"].forEach(e=>{c(()=>this[e],()=>{this.refreshHelper()})})},unmounted(){this.destroyHelper()},methods:{initHelper(){this.helper=new wi(this.size,this.divisions,this.color1,this.color2),g(this,"castShadow",this.helper),g(this,"receiveShadow",this.helper),this.initObject3D(this.helper)},destroyHelper(){var e,t;this.helper&&this.removeFromParent(this.helper),(e=this.getParent())==null||e.remove(this.helper),(t=this.helper)==null||t.dispose()},refreshHelper(){this.destroyHelper(),this.initHelper()}}}),So=Object.freeze({__proto__:null,Renderer:it,RendererInjectionKey:z,OrthographicCamera:nt,PerspectiveCamera:be,Camera:be,Group:ht,Scene:at,SceneInjectionKey:ve,Object3D:$,Raycaster:lt,CubeCamera:dt,BufferGeometry:_e,BoxGeometry:pt,CircleGeometry:yt,ConeGeometry:vt,CylinderGeometry:St,DodecahedronGeometry:xt,ExtrudeGeometry:Et,IcosahedronGeometry:Tt,LatheGeometry:Dt,OctahedronGeometry:Gt,PlaneGeometry:zt,PolyhedronGeometry:Ft,RingGeometry:Ht,SphereGeometry:Zt,ShapeGeometry:Xt,TetrahedronGeometry:qt,TorusGeometry:er,TorusKnotGeometry:sr,TubeGeometry:or,AmbientLight:ar,DirectionalLight:hr,HemisphereLight:lr,PointLight:dr,RectAreaLight:cr,SpotLight:ur,Material:Se,BasicMaterial:pr,LambertMaterial:mr,PhongMaterial:fr,PhysicalMaterial:yr,PointsMaterial:gr,ShadowMaterial:br,StandardMaterial:vr,ToonMaterial:_r,MaterialInjectionKey:Pe,MatcapMaterial:Pr,ShaderMaterial:Sr,SubSurfaceMaterial:wr,Texture:we,CubeTexture:Mr,VideoTexture:xr,Mesh:W,MeshInjectionKey:se,Box:Er,Circle:Lr,Cone:Cr,Cylinder:Tr,Dodecahedron:Or,Icosahedron:Rr,Lathe:Dr,Octahedron:Nr,Plane:jr,Polyhedron:Gr,Ring:kr,Sphere:Ar,Tetrahedron:zr,Text:Ir,Torus:$r,TorusKnot:Fr,Tube:Ur,Image:Br,InstancedMesh:Hr,Sprite:Yr,Points:Kr,GltfModel:Xr,FbxModel:Vr,EffectComposer:Wr,ComposerInjectionKey:Me,RenderPass:qr,EffectPass:k,BokehPass:Jr,FilmPass:ts,FXAAPass:rs,HalftonePass:is,SMAAPass:os,SSAOPass:ns,TiltShiftPass:ls,UnrealBloomPass:cs,ZoomBlurPass:us,GridHelper:ps,applyObjectProps:te,bindObjectProp:H,bindObjectProps:We,setFromProp:re,bindProps:qe,bindProp:g,propsValues:de,lerp:Qe,limit:Je,getMatcapUrl:Re});const ms={install(e){["Camera","OrthographicCamera","PerspectiveCamera","Raycaster","Renderer","Scene","Group","CubeCamera","AmbientLight","DirectionalLight","HemisphereLight","PointLight","RectAreaLight","SpotLight","BasicMaterial","LambertMaterial","MatcapMaterial","PhongMaterial","PhysicalMaterial","PointsMaterial","ShaderMaterial","StandardMaterial","SubSurfaceMaterial","ToonMaterial","Texture","CubeTexture","BufferGeometry","Mesh","Box","BoxGeometry","Circle","CircleGeometry","Cone","ConeGeometry","Cylinder","CylinderGeometry","Dodecahedron","DodecahedronGeometry","Icosahedron","IcosahedronGeometry","Lathe","LatheGeometry","Octahedron","OctahedronGeometry","Plane","PlaneGeometry","Polyhedron","PolyhedronGeometry","Ring","RingGeometry","Sphere","SphereGeometry","Tetrahedron","TetrahedronGeometry","Text","Torus","TorusGeometry","TorusKnot","TorusKnotGeometry","Tube","TubeGeometry","Image","InstancedMesh","Points","Sprite","FbxModel","GltfModel","BokehPass","EffectComposer","FilmPass","FXAAPass","HalftonePass","RenderPass","SAOPass","SMAAPass","SSAOPass","TiltShiftPass","UnrealBloomPass","ZoomBlurPass"].forEach(t=>{e.component(t,So[t])})}};function wo(e){return ws(e).use(ms)}function Mo(){const e={loader:new le,count:0,textures:[],loadProgress:0,loadTextures:t,dispose:s};return e;function t(i,o){e.count=i.length,e.textures.splice(0),e.loadProgress=0,Promise.all(i.map(r)).then(o)}function r(i,o){return new Promise(n=>{e.loader.load(i.src,d=>{e.loadProgress+=1/e.count,e.textures[o]=d,n(d)})})}function s(){e.textures.forEach(i=>i.dispose())}}export{ar as AmbientLight,pr as BasicMaterial,Jr as BokehPass,Er as Box,pt as BoxGeometry,_e as BufferGeometry,be as Camera,Lr as Circle,yt as CircleGeometry,Me as ComposerInjectionKey,Cr as Cone,vt as ConeGeometry,dt as CubeCamera,Mr as CubeTexture,Tr as Cylinder,St as CylinderGeometry,hr as DirectionalLight,Or as Dodecahedron,xt as DodecahedronGeometry,Wr as EffectComposer,k as EffectPass,Et as ExtrudeGeometry,rs as FXAAPass,Vr as FbxModel,ts as FilmPass,Xr as GltfModel,ps as GridHelper,ht as Group,is as HalftonePass,lr as HemisphereLight,Rr as Icosahedron,Tt as IcosahedronGeometry,Br as Image,Hr as InstancedMesh,mr as LambertMaterial,Dr as Lathe,Dt as LatheGeometry,Pr as MatcapMaterial,Se as Material,Pe as MaterialInjectionKey,W as Mesh,se as MeshInjectionKey,$ as Object3D,Nr as Octahedron,Gt as OctahedronGeometry,nt as OrthographicCamera,be as PerspectiveCamera,fr as PhongMaterial,yr as PhysicalMaterial,jr as Plane,zt as PlaneGeometry,dr as PointLight,Kr as Points,gr as PointsMaterial,Gr as Polyhedron,Ft as PolyhedronGeometry,lt as Raycaster,cr as RectAreaLight,qr as RenderPass,it as Renderer,z as RendererInjectionKey,kr as Ring,Ht as RingGeometry,os as SMAAPass,ns as SSAOPass,at as Scene,ve as SceneInjectionKey,Sr as ShaderMaterial,br as ShadowMaterial,Xt as ShapeGeometry,Ar as Sphere,Zt as SphereGeometry,ur as SpotLight,Yr as Sprite,vr as StandardMaterial,wr as SubSurfaceMaterial,zr as Tetrahedron,qt as TetrahedronGeometry,Ir as Text,we as Texture,ls as TiltShiftPass,_r as ToonMaterial,$r as Torus,er as TorusGeometry,Fr as TorusKnot,sr as TorusKnotGeometry,ms as TroisJSVuePlugin,Ur as Tube,or as TubeGeometry,cs as UnrealBloomPass,xr as VideoTexture,us as ZoomBlurPass,te as applyObjectProps,H as bindObjectProp,We as bindObjectProps,g as bindProp,qe as bindProps,wo as createApp,Re as getMatcapUrl,Qe as lerp,Je as limit,de as propsValues,re as setFromProp,Mo as useTextures};
//# sourceMappingURL=trois.module.cdn.min.js.map
